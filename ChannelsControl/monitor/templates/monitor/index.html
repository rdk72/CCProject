{% extends 'base.html' %}
{% load monitor_tags %}


{% block title %}
{{title}} :: {{block.super}}
{% endblock %}

{% block sidebar %}
{{ rand }}
{% include 'inc/_sidebar.html' %}
{% endblock %}

{% block content %}
<h1>{{title}} </h1>
<table class="table table-hover table-dark">
    <thead >
    <tr>
        <td>Оператор</td>
        <td>Каналы связи</td>
        <td>Время отключения</td>
        <td>Время включения</td>
        <td>Простой</td>
        <td>Тип проблемы</td>
        <td>Номер заявки</td>
        <td>Дополнительная информация</td>
        {% if request.resolver_match.url_name == 'history' %}
        <td>Статус</td>
        {% endif %}


    </tr>
    </thead>
    <tbody>

    {% for incident in incidents %}
    <tr>


        <td>
            <a href="{{ incident.get_absolute_url }}">
            {{ incident.provider }}
            </a>
        </td>
        <td>
        {% for channel in incident.channels.all %}
        {{ channel }}
        <br>
        {% endfor %}
        </td>
        <td>{{ incident.date_time_from|date:"d.m.y H:i" }}</td>
        <td>{{ incident.date_time_to|date:"d.m.y H:i" }}</td>
        <td>{{ incident.date_time_from|period:incident.date_time_to }}</td>
        <td>{{ incident.get_type_display }}</td>
        <td>{{ incident.request }}</td>
        <td>{{ incident.more_info }}</td>
        {% if request.resolver_match.url_name == 'history' %}

             {% if incident.state == 'I' %}
        <td class="bg-danger">
             <span >Актуальна</span>
        </td>
             {% else %}
        <td class="bg-success">
             <span >Закрыта</span>
        </td>
             {% endif %}



        {% endif %}

    </tr>

    {% endfor %}

    </tbody>
</table>
{% endblock %}